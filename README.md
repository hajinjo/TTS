# 음성합성 구현 프로젝트
> 코드스테이츠 AI03 final 개인프로젝트입니다 

### 실행방법
synth_module에서 텍스트 수정 후 실행하면 /output 에 wav 파일로 저장 

## ✔️ 개요

### 주제 선정

- Text-to-Speech 음성합성 구현
- 음성이나 음악 분야의 딥러닝 기술에 관심이 있고 전공자로서 도메인 지식을 살려 프로젝트를 진행 할 수 있을것 같아서 TTS 구현을 주제로 삼았다.

### 데이터

- **Korean single speech 데이터 :** 전문 여자 성우가 녹음한 12853개의 Wav 파일(12시간 분량, 44,100kHz, 3GB), 음성파일과 대치되는 텍스트 파일로 이루어진 데이터셋 [다운로드 ](https://www.kaggle.com/bryanpark/korean-single-speaker-speech-dataset)

### 사용한 모델

- **Tacotron2** : 2017년 구글에서 개발한 End-to-End 음성합성 모델
    - 텍스트를 가지고 바로 raw spectrogram으로 생성
    - <Text, Audio> 페어만 가지고 학습 가능
    - 음성합성 품질 테스트에서 높은 점수 획득
    
![스크린샷 2022-05-26 오후 10 43 02](https://user-images.githubusercontent.com/83392231/176823489-f8c52ee0-dd3e-4378-a1a2-996036cd127c.png)
    
Tacotron2에서는 크게 두가지 단계가 존재하는데 먼저 타코트론에서 텍스트를 받아 spectrogram으로 만들고 Wavenet이라는 waveform 생성 모델에서 앞선 spectrogram을 audio로 변경해주는 순서로 진행이 된다. 
    

## ✔️ 프로젝트 진행

### 데이터 전처리

- wav 파일이 정제된 데이터여서 크게 음성데이터 자체를 조정 할 필요는 없었음
- 타코트론 모델의 인풋 타입에 맞게 데이터 변형
    - 텍스트와 오디오 파일을 쌍으로 연결한 json 파일 생성
    - 학습에 사용될 audio, text 등의 데이터를 묶어서 numpy로 저장

### 모델 학습

- 자연스러운 음성 합성을 위해 10만 에포크 이상의 학습이 필요
- But, 현재 맥북 + conda 가상환경으로는 학습이 너무 더디게 진행되었고 또한 일주일 넘게 노트북을 쉬지않고 켜놓은채 학습을 돌려 놓을 수 없다고 판단했다
- 남은 프로젝트 기간동안 학습을 완료 할 수 없다고 생각해 동일 데이터셋으로 훈련한 타코트론 모델과 melgan을 이용해 audio 파일을 생성하는 모듈을 만들고 이 모듈을 이용해 api제작

### Flask api

- 훈련된 모델과 Flask를 이용해 텍스트를 입력하면 음성으로 바꿔주는 api 제작
    
<img width="255" alt="Untitled" src="https://user-images.githubusercontent.com/83392231/176823497-d96a8fcd-d446-4c90-b109-81ca36a24a13.png">
    

## ✔️한계점 및 개선방향

- 딥러닝, 특히 생성 쪽 학습을 하려면 좋은 GPU 필요
    - 처음으로 본격적으로 커다란 모델을 가져와 사용해봤는데 생각보다 학습에는 시간과 환경이 엄청나게 중요하다는 것을 깨닫는 경험이 되었다
    - Pre-trained 모델을 사용해 fine tuning 하는 방법 고려
- 데이터 수집의 어려움
    - 음성데이터 특성상 잡음이 섞이면 제거하기가 힘들며, 단독 화자의 정제된 고음질 데이터를 구하기 어려움.
    - 오디오와 매칭되는 텍스트도 없다면 api를 활용해야 하거나 사람이 직접 텍스트를 입력하는 경우도 존재
    - 평소에 음악 녹음 작업을 많이 했던 경험 & 마이크나 오디오 인터페이스 등의 장비도 갖춰진 상태  ⇒ 직접 녹음해서 내 목소리를 학습에 이용 할 수 있지 않을까
    
    전반적으로 경험 부족에서 오는 자잘한 실수들이 많아서 아쉬웠던 프로젝트로 음성관련해서 좀 더 공부 한 후 다시 음성합성을 도전 해보고 싶다.

